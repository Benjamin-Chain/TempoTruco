{"ast":null,"code":"/**\r\n * Utility functions for schedule conflict detection and generation\r\n */\n\n// Map days to numbers for easier comparison\nconst DAY_MAP = {\n  'L': 0,\n  // Monday (Lunes)\n  'M': 1,\n  // Tuesday (Martes)\n  'X': 2,\n  // Wednesday (Miércoles)\n  'J': 3,\n  // Thursday (Jueves)\n  'V': 4 // Friday (Viernes)\n};\n\n/**\r\n * Convert time string (HH:MM) to minutes since midnight\r\n */\nconst timeToMinutes = timeStr => {\n  const [hours, minutes] = timeStr.split(':').map(Number);\n  return hours * 60 + minutes;\n};\n\n/**\r\n * Check if two time ranges overlap\r\n */\nconst timeRangesOverlap = (start1, end1, start2, end2) => {\n  const start1Min = timeToMinutes(start1);\n  const end1Min = timeToMinutes(end1);\n  const start2Min = timeToMinutes(start2);\n  const end2Min = timeToMinutes(end2);\n  return start1Min < end2Min && start2Min < end1Min;\n};\n\n/**\r\n * Check if two subjects have a schedule conflict\r\n */\nexport const hasConflict = (subject1, subject2) => {\n  // If either subject has no schedule, no conflict\n  if (!subject1.schedule || !subject2.schedule) {\n    return false;\n  }\n\n  // Check if they share any common day\n  const commonDays = subject1.days.filter(day => subject2.days.includes(day));\n  if (commonDays.length === 0) {\n    return false; // No common days, no conflict\n  }\n\n  // Check time overlap for each common day\n  for (const day of commonDays) {\n    // Get the schedule for this day\n    let schedule1 = subject1.schedule;\n    let schedule2 = subject2.schedule;\n\n    // Handle subjects with different schedules on different days (like Admin I)\n    // Check if this day is the last day and subject has schedule2\n    const dayIndex1 = subject1.days.indexOf(day);\n    const dayIndex2 = subject2.days.indexOf(day);\n\n    // Only use schedule2 if this specific day is the last day in the array\n    if (subject1.schedule2 && dayIndex1 === subject1.days.length - 1) {\n      schedule1 = subject1.schedule2;\n    }\n    if (subject2.schedule2 && dayIndex2 === subject2.days.length - 1) {\n      schedule2 = subject2.schedule2;\n    }\n    if (schedule1 && schedule2) {\n      // Check if time ranges overlap\n      const overlaps = timeRangesOverlap(schedule1.start, schedule1.end, schedule2.start, schedule2.end);\n      if (overlaps) {\n        return true; // Conflict found\n      }\n    }\n  }\n  return false;\n};\n\n/**\r\n * Check if a set of subjects has any conflicts\r\n */\nexport const hasAnyConflict = subjects => {\n  for (let i = 0; i < subjects.length; i++) {\n    for (let j = i + 1; j < subjects.length; j++) {\n      if (hasConflict(subjects[i], subjects[j])) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\n/**\r\n * Get all conflicts in a set of subjects\r\n * Returns an array of pairs [subject1, subject2] that conflict\r\n */\nexport const getConflicts = subjects => {\n  const conflicts = [];\n  for (let i = 0; i < subjects.length; i++) {\n    for (let j = i + 1; j < subjects.length; j++) {\n      if (hasConflict(subjects[i], subjects[j])) {\n        conflicts.push([subjects[i], subjects[j]]);\n      }\n    }\n  }\n  return conflicts;\n};\n\n/**\r\n * Get set of subject IDs that have conflicts\r\n */\nexport const getConflictingSubjectIds = subjects => {\n  const conflictingIds = new Set();\n  const conflicts = getConflicts(subjects);\n  conflicts.forEach(([subj1, subj2]) => {\n    conflictingIds.add(subj1.id);\n    conflictingIds.add(subj2.id);\n  });\n  return conflictingIds;\n};\n\n/**\r\n * Generate all possible combinations of selected subjects without conflicts\r\n */\nexport const generateValidSchedules = selectedSubjects => {\n  if (selectedSubjects.length === 0) {\n    return [];\n  }\n\n  // Validate all subjects are from the same semester (only semester, not year)\n  const semesters = new Set(selectedSubjects.map(s => s.semester));\n  if (semesters.size > 1) {\n    return []; // Different semesters selected\n  }\n\n  // Generate all combinations (power set)\n  const combinations = [];\n  const n = selectedSubjects.length;\n\n  // Generate from 1 to n subjects (at least one subject)\n  for (let mask = 1; mask < 1 << n; mask++) {\n    const combination = [];\n    for (let i = 0; i < n; i++) {\n      if (mask & 1 << i) {\n        combination.push(selectedSubjects[i]);\n      }\n    }\n\n    // Check if this combination has no conflicts\n    if (!hasAnyConflict(combination)) {\n      combinations.push(combination);\n    }\n  }\n\n  // Sort by number of subjects (descending) to show most complete schedules first\n  combinations.sort((a, b) => b.length - a.length);\n  return combinations;\n};\n\n/**\r\n * Get a color for a subject (for visualization)\r\n */\nconst colors = ['#4A90E2', '#50C878', '#FF6B6B', '#FFA500', '#9B59B6', '#1ABC9C', '#E74C3C', '#3498DB', '#F39C12', '#E91E63', '#00BCD4', '#8BC34A', '#FF5722', '#673AB7', '#009688'];\nlet colorIndex = 0;\nconst subjectColors = new Map();\nexport const getSubjectColor = subjectId => {\n  if (!subjectColors.has(subjectId)) {\n    subjectColors.set(subjectId, colors[colorIndex % colors.length]);\n    colorIndex++;\n  }\n  return subjectColors.get(subjectId);\n};\n\n/**\r\n * Reset color mapping (useful when starting a new selection)\r\n */\nexport const resetColors = () => {\n  subjectColors.clear();\n  colorIndex = 0;\n};","map":{"version":3,"names":["DAY_MAP","timeToMinutes","timeStr","hours","minutes","split","map","Number","timeRangesOverlap","start1","end1","start2","end2","start1Min","end1Min","start2Min","end2Min","hasConflict","subject1","subject2","schedule","commonDays","days","filter","day","includes","length","schedule1","schedule2","dayIndex1","indexOf","dayIndex2","overlaps","start","end","hasAnyConflict","subjects","i","j","getConflicts","conflicts","push","getConflictingSubjectIds","conflictingIds","Set","forEach","subj1","subj2","add","id","generateValidSchedules","selectedSubjects","semesters","s","semester","size","combinations","n","mask","combination","sort","a","b","colors","colorIndex","subjectColors","Map","getSubjectColor","subjectId","has","set","get","resetColors","clear"],"sources":["C:/Users/Jaben/Documents/GitHub/TiempoTruco/src/utils/scheduleUtils.js"],"sourcesContent":["/**\r\n * Utility functions for schedule conflict detection and generation\r\n */\r\n\r\n// Map days to numbers for easier comparison\r\nconst DAY_MAP = {\r\n  'L': 0, // Monday (Lunes)\r\n  'M': 1, // Tuesday (Martes)\r\n  'X': 2, // Wednesday (Miércoles)\r\n  'J': 3, // Thursday (Jueves)\r\n  'V': 4  // Friday (Viernes)\r\n};\r\n\r\n/**\r\n * Convert time string (HH:MM) to minutes since midnight\r\n */\r\nconst timeToMinutes = (timeStr) => {\r\n  const [hours, minutes] = timeStr.split(':').map(Number);\r\n  return hours * 60 + minutes;\r\n};\r\n\r\n/**\r\n * Check if two time ranges overlap\r\n */\r\nconst timeRangesOverlap = (start1, end1, start2, end2) => {\r\n  const start1Min = timeToMinutes(start1);\r\n  const end1Min = timeToMinutes(end1);\r\n  const start2Min = timeToMinutes(start2);\r\n  const end2Min = timeToMinutes(end2);\r\n  \r\n  return start1Min < end2Min && start2Min < end1Min;\r\n};\r\n\r\n/**\r\n * Check if two subjects have a schedule conflict\r\n */\r\nexport const hasConflict = (subject1, subject2) => {\r\n  // If either subject has no schedule, no conflict\r\n  if (!subject1.schedule || !subject2.schedule) {\r\n    return false;\r\n  }\r\n\r\n  // Check if they share any common day\r\n  const commonDays = subject1.days.filter(day => subject2.days.includes(day));\r\n  \r\n  if (commonDays.length === 0) {\r\n    return false; // No common days, no conflict\r\n  }\r\n\r\n  // Check time overlap for each common day\r\n  for (const day of commonDays) {\r\n    // Get the schedule for this day\r\n    let schedule1 = subject1.schedule;\r\n    let schedule2 = subject2.schedule;\r\n    \r\n    // Handle subjects with different schedules on different days (like Admin I)\r\n    // Check if this day is the last day and subject has schedule2\r\n    const dayIndex1 = subject1.days.indexOf(day);\r\n    const dayIndex2 = subject2.days.indexOf(day);\r\n    \r\n    // Only use schedule2 if this specific day is the last day in the array\r\n    if (subject1.schedule2 && dayIndex1 === subject1.days.length - 1) {\r\n      schedule1 = subject1.schedule2;\r\n    }\r\n    if (subject2.schedule2 && dayIndex2 === subject2.days.length - 1) {\r\n      schedule2 = subject2.schedule2;\r\n    }\r\n\r\n    if (schedule1 && schedule2) {\r\n      // Check if time ranges overlap\r\n      const overlaps = timeRangesOverlap(\r\n        schedule1.start,\r\n        schedule1.end,\r\n        schedule2.start,\r\n        schedule2.end\r\n      );\r\n      \r\n      if (overlaps) {\r\n        return true; // Conflict found\r\n      }\r\n    }\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\n/**\r\n * Check if a set of subjects has any conflicts\r\n */\r\nexport const hasAnyConflict = (subjects) => {\r\n  for (let i = 0; i < subjects.length; i++) {\r\n    for (let j = i + 1; j < subjects.length; j++) {\r\n      if (hasConflict(subjects[i], subjects[j])) {\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\n/**\r\n * Get all conflicts in a set of subjects\r\n * Returns an array of pairs [subject1, subject2] that conflict\r\n */\r\nexport const getConflicts = (subjects) => {\r\n  const conflicts = [];\r\n  for (let i = 0; i < subjects.length; i++) {\r\n    for (let j = i + 1; j < subjects.length; j++) {\r\n      if (hasConflict(subjects[i], subjects[j])) {\r\n        conflicts.push([subjects[i], subjects[j]]);\r\n      }\r\n    }\r\n  }\r\n  return conflicts;\r\n};\r\n\r\n/**\r\n * Get set of subject IDs that have conflicts\r\n */\r\nexport const getConflictingSubjectIds = (subjects) => {\r\n  const conflictingIds = new Set();\r\n  const conflicts = getConflicts(subjects);\r\n  conflicts.forEach(([subj1, subj2]) => {\r\n    conflictingIds.add(subj1.id);\r\n    conflictingIds.add(subj2.id);\r\n  });\r\n  return conflictingIds;\r\n};\r\n\r\n/**\r\n * Generate all possible combinations of selected subjects without conflicts\r\n */\r\nexport const generateValidSchedules = (selectedSubjects) => {\r\n  if (selectedSubjects.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  // Validate all subjects are from the same semester (only semester, not year)\r\n  const semesters = new Set(selectedSubjects.map(s => s.semester));\r\n  if (semesters.size > 1) {\r\n    return []; // Different semesters selected\r\n  }\r\n\r\n  // Generate all combinations (power set)\r\n  const combinations = [];\r\n  const n = selectedSubjects.length;\r\n  \r\n  // Generate from 1 to n subjects (at least one subject)\r\n  for (let mask = 1; mask < (1 << n); mask++) {\r\n    const combination = [];\r\n    for (let i = 0; i < n; i++) {\r\n      if (mask & (1 << i)) {\r\n        combination.push(selectedSubjects[i]);\r\n      }\r\n    }\r\n    \r\n    // Check if this combination has no conflicts\r\n    if (!hasAnyConflict(combination)) {\r\n      combinations.push(combination);\r\n    }\r\n  }\r\n\r\n  // Sort by number of subjects (descending) to show most complete schedules first\r\n  combinations.sort((a, b) => b.length - a.length);\r\n\r\n  return combinations;\r\n};\r\n\r\n/**\r\n * Get a color for a subject (for visualization)\r\n */\r\nconst colors = [\r\n  '#4A90E2', '#50C878', '#FF6B6B', '#FFA500', '#9B59B6',\r\n  '#1ABC9C', '#E74C3C', '#3498DB', '#F39C12', '#E91E63',\r\n  '#00BCD4', '#8BC34A', '#FF5722', '#673AB7', '#009688'\r\n];\r\n\r\nlet colorIndex = 0;\r\nconst subjectColors = new Map();\r\n\r\nexport const getSubjectColor = (subjectId) => {\r\n  if (!subjectColors.has(subjectId)) {\r\n    subjectColors.set(subjectId, colors[colorIndex % colors.length]);\r\n    colorIndex++;\r\n  }\r\n  return subjectColors.get(subjectId);\r\n};\r\n\r\n/**\r\n * Reset color mapping (useful when starting a new selection)\r\n */\r\nexport const resetColors = () => {\r\n  subjectColors.clear();\r\n  colorIndex = 0;\r\n};\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}